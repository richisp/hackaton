"use strict";function _extends(){return _extends=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},_extends.apply(this,arguments)}function _instanceof(n,t){return t!=null&&typeof Symbol!="undefined"&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](n):n instanceof t}function _typeof(n){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(n)}function _classCallCheck(n,t){if(!_instanceof(n,t))throw new TypeError("Cannot call a class as a function");}function _defineProperties(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function _createClass(n,t,i){return t&&_defineProperties(n.prototype,t),i&&_defineProperties(n,i),n}function _possibleConstructorReturn(n,t){return t&&(_typeof(t)==="object"||typeof t=="function")?t:_assertThisInitialized(n)}function _getPrototypeOf(n){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},_getPrototypeOf(n)}function _assertThisInitialized(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}});t&&_setPrototypeOf(n,t)}function _setPrototypeOf(n,t){return _setPrototypeOf=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},_setPrototypeOf(n,t)}function _defineProperty(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}var AddToCartPiCarousel=function(n){function t(n){var i;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n)),_defineProperty(_assertThisInitialized(i),"handleStoreUpdated",function(n){i.setState(n);i.loadPiCarouselSettings()}),_defineProperty(_assertThisInitialized(i),"loadPiCarouselSettings",function(){if(i.state.addToCartPiData===null||i.state.addToCartPiData===undefined){i.setState({carouselData:null});return}Crate.PiV2.getPiCarouselSettings(i.props.callbackUrl,i.state.addToCartPiData).done(function(n){i.setCarouselData(n)})}),_defineProperty(_assertThisInitialized(i),"setCarouselData",function(n){i.setState({carouselData:n})}),i.Store=Crate.React.Stores.CrossSellStore,i.Actions=Crate.React.Actions.CrossSellActions,i.state={carouselData:null},i}return _inherits(t,n),_createClass(t,[{key:"componentWillMount",value:function(){typeof window!="undefined"&&window.window===window&&this.Actions.fetchAddToCartPiData.defer(this.props.sourceUrl);this.Store.listen(this.handleStoreUpdated)}},{key:"componentWillUnmount",value:function(){this.Store.unlisten(this.handleStoreUpdated)}},{key:"render",value:function(){return this.state.carouselData&&React.createElement("section",{className:"section-additional-items",id:this.props.name},React.createElement(Carousel,{json:this.state.carouselData,isLazyLoadComponent:!1,settings:this.state.carouselData.settings,isInternational:this.props.isInternational}))}}]),t}(React.Component),Carousel=function(n){function t(n){var i;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n)),_defineProperty(_assertThisInitialized(i),"getState",function(n){var i=typeof n.json=="string"?JSON.parse(n.json):n.json,t=typeof n.settings=="string"?JSON.parse(n.settings):n.settings;return t.prevArrow=React.createElement("button",{className:"slick-arrow","aria-label":"Previous",onClick:n.onClick},React.createElement("svg",{className:"icon svg-icon-arrow-left","aria-hidden":"true",focusable:"false"},React.createElement("use",{xlinkHref:"#svg-icon-arrow-left"})),React.createElement("span",{className:"sr-only"},"Previous")),t.nextArrow=React.createElement("button",{className:"slick-arrow","aria-label":"Next",onClick:n.onClick},React.createElement("svg",{className:"icon svg-icon-arrow-right","aria-hidden":"true",focusable:"false"},React.createElement("use",{xlinkHref:"#svg-icon-arrow-right"})),React.createElement("span",{className:"sr-only"},"Next")),{json:i,settings:t,isMobile:n.isMobile,unslick:n.unslick!==undefined?n.unslick:!1,isLazyLoaded:!n.isLazyLoadComponent}}),_defineProperty(_assertThisInitialized(i),"handleLazyLoad",function(){i.setState({isLazyLoaded:!0},function(){setTimeout(function(){i.handleSliderBeforeChange();i.handleSliderAfterChange(0)},250)})}),i.state=i.getState(n),i.handleSliderAfterChange=i.handleSliderAfterChange.bind(_assertThisInitialized(i)),i.fnIsIpad=i.fnIsIpad.bind(_assertThisInitialized(i)),i.handleSliderBeforeChange=i.handleSliderBeforeChange.bind(_assertThisInitialized(i)),i.setFocusable=i.setFocusable.bind(_assertThisInitialized(i)),i.keys=[],i}return _inherits(t,n),_createClass(t,[{key:"componentWillReceiveProps",value:function(n){n.json!==this.props.json&&this.setState(this.getState(n))}},{key:"fnIsIpad",value:function(){if(navigator&&navigator.userAgent&&navigator.userAgent!=null){var n=navigator.userAgent.toLowerCase(),t=n.match(/(ipad)/);if(t!=null)return!0}return!1}},{key:"handleSliderBeforeChange",value:function(){var n=this.state.json.items.length;this.setFocusable(".slick-slide a.carousel-item-link",!1);this.setFocusable(".slick-slide button.button-add-single",!1);this.setFocusable(".slick-slide input.field-qty",!1)}},{key:"handleSliderAfterChange",value:function(n){var u=this.state.settings.slidesToShow,i=this.state.json.items.length,r=n+u,t;for(r>i&&(r=i,n=i-u),n<0&&(n=0),t=n;t<r;t++)this.setFocusable(".slick-slide[data-index='"+t+"'] a.carousel-item-link",!0),this.setFocusable(".slick-slide[data-index='"+t+"'] button.button-add-single",!0),this.setFocusable(".slick-slide[data-index='"+t+"'] input.field-qty",!0);this.setFocusable(".slick-arrow.slick-disabled",!1);this.setFocusable(".slick-arrow:not(.slick-disabled)",!0)}},{key:"setFocusable",value:function(n,t){for(var r=document.querySelectorAll("#".concat(this.sliderId," ").concat(n)),i=0;i<r.length;i++)t?(r[i].tabIndex=0,r[i].setAttribute("aria-hidden","false")):(r[i].tabIndex=-1,r[i].setAttribute("aria-hidden","true"))}},{key:"componentDidMount",value:function(){var i=this.state.json,n=this.state.settings,t;i.items.length<4&&(i.items.length<4?n.responsive=[{breakpoint:768,settings:"unslick"}]:"",this.setState({unslick:!0}));t=i.items.length>n.slidesToShow;n.arrows=t;n.draggable=t;n.infinite=t;this.setState({ipadActiveClass:this.fnIsIpad()?" ipad-active":"",settings:n});this.state.isLazyLoaded||Crate.Services.LazyLoadService.watchReactElement(this.refs.carousel,this.handleLazyLoad,"500px 200px")}},{key:"getUniqueKey",value:function(n,t){for(var i=n+t;this.keys.indexOf(i)>=0;)i+=1;return this.keys.push(i),i}},{key:"render",value:function(){var n=this,t=this.state.json,i="carousel-item-container "+(typeof Window=="undefined"&&this.props.isMobile?"server-side-rendered":""),u=this.state.unslick?" carousel-item-centered":"",f=this.state.unslick&&this.props.isMobile?" carousel-unslick":"",r=this.props.isInternational,e=this.state.json.header,o=Object.assign({beforeChange:this.handleSliderBeforeChange,afterChange:this.handleSliderAfterChange},this.state.settings),s=this.props.optionalHtml&&!t.items.length>0?React.createElement("div",{className:i},React.createElement("h2",{className:"section-header carousel-item-header"},t.header),React.createElement("p",{className:"section-tagline"},t.subHeader),this.props.optionalHtml):null,h=t.piId!==null&&t.piId!==undefined?"-"+"".concat(t.piId):"",c="carousel-".concat(t.header.replace(/\s+/g,"")).concat(h),l=function(t){return React.createElement("div",{id:c,className:i},React.createElement("h2",{className:"section-header carousel-item-header"},n.props.isCb2&&n.props.header?n.props.header:t.data.header),n.props.isCb2||t.data.isCb2?"":React.createElement("p",{className:"section-tagline"},t.data.subHeader),n.props.optionalHtml,n.state.isLazyLoaded&&React.createElement("div",{className:"carousel-x carousel-item-group"+u+f+n.state.ipadActiveClass},t.data.header==="Our Designers Recommend"&&typeof Window=="undefined"&&n.state.isMobile===!1?t.data.items.map(function(t,i){var u=n.getUniqueKey(t.id,i);return React.createElement("div",{key:u},React.createElement(Each,{each:t,isInternational:r}))}):React.createElement(Slider,t.sliderSettings,t.data.items.map(function(t,i){var u=n.getUniqueKey(t.id,i);return t.imagePath&&React.createElement("div",{key:u},React.createElement(Each,{defaultVersion:n.props.defaultVersion,itemCount:"User Image ".concat(u," of ").concat(n.state.json.items.length),role:n.props.role,each:t,isInternational:r,location:e,isMobile:n.props.isMobile,handleClick:function(t){return n.props.handleClick(t)},isQuantityBoxVisible:n.state.json.isQuantityBoxVisible}))}))))};return React.createElement("div",{ref:"carousel"},t!==undefined&&t.items.length>0?React.createElement(l,{data:t,sliderSettings:o}):s)}}]),t}(React.Component),Each=function(n){function t(n){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n))}return _inherits(t,n),_createClass(t,[{key:"componentDidMount",value:function(){var n=this.focusedElement;this.fe=new A11yKeyboardFocus(n);this.fe.focusInOut()}},{key:"handleClick",value:function(n){var t=n.currentTarget,i=t.getAttribute("data-url");i&&(n.stopPropagation(),n.preventDefault(),Crate.PiV2.hrefDelegate(t))}},{key:"render",value:function(){var t=this,n=this.props.each,i=typeof Window=="undefined"?" jsLazyLoad":"",r=typeof Window=="undefined"&&this.props.isMobile?"https://images.crateandbarrel.com/is/image/Crate/loading_swatch_mobile":n.imagePath,u=this.props.isQuantityBoxVisible!==undefined?this.props.isQuantityBoxVisible:!0,f=this.props.each.lineLevelMessages&&this.props.each.lineLevelMessages.primary.shortMessage!==null?React.createElement("span",{className:"line-level-primary-short"},this.props.each.lineLevelMessages.primary.shortMessage):"";return React.createElement("div",{ref:function(n){return t.focusedElement=n},className:"carousel-item"},this.props.defaultVersion?React.createElement("a",{href:n.navigateUrl,role:this.props.role,title:n.name?n.name:this.props.itemCount,"data-url":n.dataUrl,"data-crateurl":n.navigateUrl,className:"carousel-item-link",onKeyPress:function(){return event.code==="Space"||event.code==="Enter"?t.props.handleClick(n.id):""},onClick:function(){return t.props.handleClick(n.id)}},React.createElement("img",{className:"carousel-item-img"+i,src:r,"data-src":n.imagePath,"aria-hidden":"true",alt:n.name?n.name:this.props.itemCount,"data-primaryimgpath":n.imagePath})):React.createElement("div",null,React.createElement("a",{href:n.navigateUrl,title:n.name,"data-url":n.dataUrl,"data-crateurl":n.navigateUrl,className:"carousel-item-link",onClick:this.handleClick},React.createElement("img",{className:"carousel-item-img"+i,src:r,"data-src":n.imagePath,"aria-hidden":"true",alt:n.name,"data-primaryimgpath":n.imagePath})),React.createElement("div",{className:"carousel-item-detail"},React.createElement("h3",{className:"detail-name"},n.isNew&&React.createElement("span",{className:"detail-name-flag"},"New"),n.name),React.createElement("span",{className:"detail-price",dangerouslySetInnerHTML:{__html:n.formatedPrice}}),f,React.createElement("span",{className:"shipping-message nsInt"},n.shippingMessage),React.createElement("div",{className:"detail-form"},!this.props.isInternational&&React.createElement(ShopButton,{sku:n.id,location:this.props.location,isQuantityBoxVisible:u,productIndex:n.sequence,maxResults:n.totalPositions},React.createElement(AddToCart,{navigateUrl:n.navigateUrl,location:this.props.location,isCarousel:!0,productIndex:n.sequence,maxResults:n.totalPositions}))))))}}]),t}(React.Component),PiCarousel,SearchZoomableCarousel,ZoomableCarousel;PiCarousel=function(n){function t(n){var i;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n)),_defineProperty(_assertThisInitialized(i),"handleStoreUpdated",function(n){i.state.carouselData===null&&(i.setState(n),i.loadPiCarouselSettings())}),_defineProperty(_assertThisInitialized(i),"loadPiCarouselSettings",function(){if(i.state.piData===null||i.state.piData===undefined){i.setState({carouselData:null});return}Crate.PiV2.getPiCarouselSettings(i.props.callbackUrl,i.state.piData).done(function(n){i.setCarouselData(n)})}),_defineProperty(_assertThisInitialized(i),"setCarouselData",function(n){i.setState({carouselData:n})}),i.Store=Crate.React.Stores.CrossSellStore,i.Actions=Crate.React.Actions.CrossSellActions,i.state={carouselData:null},i}return _inherits(t,n),_createClass(t,[{key:"componentWillMount",value:function(){typeof window!="undefined"&&window.window===window&&this.Actions.fetchPiData.defer(this.props.sourceUrl);this.Store.listen(this.handleStoreUpdated)}},{key:"componentWillReceiveProps",value:function(n){this.props.sourceUrl!==n.sourceUrl&&this.Actions.fetchPiData.defer(n.sourceUrl)}},{key:"componentWillUnmount",value:function(){this.Store.unlisten(this.handleStoreUpdated)}},{key:"render",value:function(){return this.state.carouselData&&React.createElement("section",{className:"section-additional-items",id:this.props.name},React.createElement(Carousel,{json:this.state.carouselData,isLazyLoadComponent:!0,settings:this.state.carouselData.settings,isInternational:this.props.isInternational}))}}]),t}(React.Component);SearchZoomableCarousel=function(n){var t=n.showcaseData;typeof n.showcaseData=="string"&&(t=JSON.parse(n.showcaseData));var i={data:t,format:n.format,hasPopupMirror:n.hasPopupMirror,arrows:n.arrows,isMobile:n.isMobile,legendSlidesToShow:n.legendSlidesToShow,itemClass:n.itemClass},u="".concat(t.originUrl).concat(t.navigateUrl),r="showcase-widget "+(typeof Window=="undefined"&&n.isMobile?"server-side-rendered":"");return React.createElement("div",{className:r},React.createElement(SearchImageZoom,_extends({},i,{isCb2:n.isCb2,isKids:n.isKids})))};SearchZoomableCarousel.defaultProps={hasPopupMirror:!1,arrows:!1,isMobile:!1};ZoomableCarousel=function(n){function t(n){var i;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n)),i.showcaseData=typeof n.showcaseData=="string"?JSON.parse(n.showcaseData):n.showcaseData,i.state={targetImg:i.showcaseData.imageSrc,alt:i.showcaseData.name,arrOfImg:i.showcaseData.images},i}return _inherits(t,n),_createClass(t,[{key:"render",value:function(){var t={data:this.showcaseData,format:this.props.format,hasPopupMirror:this.props.hasPopupMirror,arrows:this.props.arrows,isMobile:this.props.isMobile,legendSlidesToShow:this.props.legendSlidesToShow,itemClass:this.props.itemClass},n="".concat(this.showcaseData.originUrl).concat(this.showcaseData.navigateUrl),i="showcase-widget "+(typeof Window=="undefined"&&this.props.isMobile?"server-side-rendered":"");return React.createElement("div",{className:i},React.createElement(ImageZoom,_extends({},t,{isCb2:this.props.isCb2}),React.createElement(SocialMediaButtons,{isCb2:this.props.isCb2},React.createElement(PinItButton,{navigateUrl:n,imageName:this.showcaseData.imageSrc,description:this.showcaseData.description}),React.createElement(FacebookButtons,{navigateUrl:n}),React.createElement(HouzzButton,{houzzId:this.showcaseData.houzzId,navigateUrl:n,imageName:this.showcaseData.imageSrc,title:this.showcaseData.title,description:this.showcaseData.description,categoryName:this.showcaseData.categoryName}))))}}]),t}(React.Component);ZoomableCarousel.defaultProps={hasPopupMirror:!1,arrows:!1,isMobile:!1}