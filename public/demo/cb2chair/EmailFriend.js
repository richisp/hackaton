"use strict";function _instanceof(n,t){return t!=null&&typeof Symbol!="undefined"&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](n):n instanceof t}function _typeof(n){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(n)}function _classCallCheck(n,t){if(!_instanceof(n,t))throw new TypeError("Cannot call a class as a function");}function _defineProperties(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function _createClass(n,t,i){return t&&_defineProperties(n.prototype,t),i&&_defineProperties(n,i),n}function _possibleConstructorReturn(n,t){return t&&(_typeof(t)==="object"||typeof t=="function")?t:_assertThisInitialized(n)}function _assertThisInitialized(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _getPrototypeOf(n){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},_getPrototypeOf(n)}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}});t&&_setPrototypeOf(n,t)}function _setPrototypeOf(n,t){return _setPrototypeOf=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},_setPrototypeOf(n,t)}var EmailFriendPopup=function(n){function t(n){var i;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n)),i.state={hasError:!1,isSubmitted:!1,resultMessage:"",senderMailError:!1,recipientEmailError:!1},i}return _inherits(t,n),_createClass(t,[{key:"showDialog",value:function(){if(Crate.React.Actions.GrouperActions.validate()){var n=React.createElement(t,{isCb2:this.props.isCb2,sku:this.props.sku,familyId:this.props.familyId,categoryId:this.props.categoryId,showPopup:!0});Crate.React.Actions.PopupActions.updateContent({content:n,title:"Email a Friend",containerClasses:["narrow"]})}}},{key:"validateEmails",value:function(){var n=!1;return(this.isValidEmail(this.senderEmail.value)?(this.setState({senderMailError:!1}),this.senderEmail.classList.remove("input-validation-error")):(this.setState({senderMailError:!0,hasError:!0}),n=!0,this.senderEmail.focus(),this.senderEmail.classList.add("input-validation-error")),this.isValidEmail(this.recipientEmail.value)?(this.setState({recipientEmailError:!1}),this.recipientEmail.classList.remove("input-validation-error")):(this.setState({recipientEmailError:!0,hasError:!0}),n||this.recipientEmail.focus(),n=!0,this.recipientEmail.classList.add("input-validation-error")),n)?!1:(this.setState({hasError:!1,senderMailError:!1,recipientEmailError:!1}),!0)}},{key:"isValidEmail",value:function(n){return n==""?!1:/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(n)?!0:!1}},{key:"handleEnterKey",value:function(n){(n.keyCode==13||n.which==13)&&this.submitForm(n)}},{key:"submitForm",value:function(){var t=this,n;this.validateEmails()&&(n={Sender:this.senderEmail.value,Recipients:this.recipientEmail.value,FamilyId:this.props.familyId,CategoryId:this.props.categoryId,Sku:this.props.sku,OptIn:this.joinEmailList.checked},Crate.Services.HttpService.post("/browse/popup/emailfriendsubmit",n).then(function(n){t.setState({isSubmitted:!0,resultMessage:n.ResultMessage})}))}},{key:"render",value:function(){var n=this;if(this.props.showPopup){if(this.state.isSubmitted!="")return React.createElement("div",{className:"email-a-friend"},React.createElement("h2",{className:"section-subheading"},"Email a Friend"),React.createElement("div",{className:"validation-email success"},this.state.resultMessage));var i=this.state.senderMailError?"input-error":"hidden",r=this.state.recipientEmailError?"input-error":"hidden",t=this.props.isCb2?"CB2":"Crate and Barrel";return React.createElement("div",{className:"email-a-friend"},React.createElement("h2",{className:"section-subheading"},"Email a Friend"),React.createElement("div",{className:"js-form-content"},React.createElement("p",{id:"instructions",className:"instructions"},"Please complete the fields below, and we'll forward your friends an email from you with a link to this page. Your friends' names will not be added to our email list unless they personally choose to sign up."),React.createElement("div",{className:"email-wrap",onKeyPress:function(t){return n.handleEnterKey(t)}},React.createElement("label",{htmlFor:"SenderEmail",className:"input-emails"},"Your email address: ",React.createElement("span",{className:"required"},"required")),React.createElement("input",{id:"SenderEmail",name:"Sender",className:"",type:"email",maxLength:"66",placeholder:"john@hotmail.com",ref:function(t){n.senderEmail=t},"aria-describedby":"SenderEmailError"}),React.createElement("span",{id:"SenderEmailError",className:i},React.createElement("svg",{className:"icon svg-icon-error","aria-hidden":"true",focusable:"false"},React.createElement("use",{xlinkHref:"#svg-icon-error"})),"Please enter a valid email address (i.e. name@domain.com).")),React.createElement("div",{className:"email-wrap",onKeyPress:function(t){return n.handleEnterKey(t)}},React.createElement("input",{id:"RecipientEmails",name:"Recipients",className:"",type:"text",maxLength:"66",placeholder:"john@hotmail.com, jane@hotmail.com",ref:function(t){n.recipientEmail=t},"aria-describedby":"RecipientEmailsError"}),React.createElement("span",{id:"RecipientEmailsError",className:r},React.createElement("svg",{className:"icon svg-icon-error","aria-hidden":"true",focusable:"false"},React.createElement("use",{xlinkHref:"#svg-icon-error"})),"Please enter a valid email address (i.e. name@domain.com).")),React.createElement("div",{className:"email-wrap ckbox-subscrible"},React.createElement("input",{type:"checkbox",id:"joinEmailList",value:"Yes",className:"ckBox a11y-checkbox",ref:function(t){n.joinEmailList=t}}),React.createElement("label",{htmlFor:"joinEmailList",className:"ckBoxLabel a11y-checkbox-label"},"Yes, I would like to join the ",t," mailing list and be notified of news and happenings at ",t," via this email address.")),React.createElement("button",{className:"button button-primary button-submit",onClick:function(t){return n.submitForm(t)}},this.props.isCb2?"Send Email":"Submit")))}return React.createElement("div",null,React.createElement("button",{onClick:function(t){return n.showDialog(t)}},React.createElement("svg",{className:"icon svg-icon-email","aria-hidden":"true",focusable:"false"},React.createElement("use",{xlinkHref:"#svg-icon-email"})),React.createElement("span",null,"Email",React.createElement("span",{className:"sr-only"}," a link to this page to someone"))))}}]),t}(React.Component)