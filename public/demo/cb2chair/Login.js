"use strict";function _extends(){return _extends=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},_extends.apply(this,arguments)}function _instanceof(n,t){return t!=null&&typeof Symbol!="undefined"&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](n):n instanceof t}function _typeof(n){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(n)}function _classCallCheck(n,t){if(!_instanceof(n,t))throw new TypeError("Cannot call a class as a function");}function _defineProperties(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function _createClass(n,t,i){return t&&_defineProperties(n.prototype,t),i&&_defineProperties(n,i),n}function _possibleConstructorReturn(n,t){return t&&(_typeof(t)==="object"||typeof t=="function")?t:_assertThisInitialized(n)}function _getPrototypeOf(n){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},_getPrototypeOf(n)}function _assertThisInitialized(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}});t&&_setPrototypeOf(n,t)}function _setPrototypeOf(n,t){return _setPrototypeOf=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},_setPrototypeOf(n,t)}var ForgotPassword=function(n){function t(n){var i;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n)),i.state={message:null},i.emailRegex=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z]{2,4})+$/,i.handleSubmit=i.handleSubmit.bind(_assertThisInitialized(i)),i.validateForm=i.validateForm.bind(_assertThisInitialized(i)),i}return _inherits(t,n),_createClass(t,[{key:"componentWillReceiveProps",value:function(n){n.message&&this.setState({message:n.message})}},{key:"handleSubmit",value:function(n){n.preventDefault();var t=this.form,i=t.querySelector("#ForgotPasswordEmailAddress").value;if(this.validateForm())this.props.onSubmit(i)}},{key:"validateForm",value:function(){var n=this.form,t=n.querySelector("#ForgotPasswordEmailAddress").value;return this.emailRegex.test(t)?!0:(this.setState({message:"Please enter a valid Email Address (i.e. name@domain.com)."}),!1)}},{key:"render",value:function(){var n=this;return React.createElement("form",{ref:function(t){return n.form=t}},React.createElement("fieldset",{className:"forgot-password-popup"},React.createElement("legend",{className:"sr-only"},"Reset Password"),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-12"},React.createElement("h1",{className:"forgot-password-title"},"Forgot your password?"),React.createElement("p",{className:"forgot-password-msg"},"Enter your email address below and we will send you instructions to reset your password."),React.createElement("div",null,React.createElement("label",{htmlFor:"EmailAddress"},"Email Address",React.createElement("span",null," required")),React.createElement("input",{type:"email",className:"input-xl",name:"EmailAddress",id:"ForgotPasswordEmailAddress",maxlength:"66",autocomplete:"off"}),React.createElement("span",{id:"ForgotPasswordEmailError",className:"field-validation-valid","data-valmsg-htmlFor":"ForgotPasswordEmailAddress","data-valmsg-replace":"true",dangerouslySetInnerHTML:{__html:this.state.message}})))),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-12"},React.createElement("button",{className:"button button-primary button-submit",onClick:this.handleSubmit},"Submit")))))}}]),t}(React.Component),ForgotPasswordConfirmation=function(n){return React.createElement("fieldset",null,React.createElement("legend",{className:"sr-only"},"Reset Password"),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-12"},React.createElement("p",{className:"success"},n.message))))},Login=function(n){function t(n){var i;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n)),i.state={form:{emailAddress:null,password:null,rememberMe:!0},emailErrorMessage:null,passwordErrorMessage:n.errorMessage},i.emailRegex=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z]{2,4})+$/,i.handleFormChange=i.handleFormChange.bind(_assertThisInitialized(i)),i.handleSubmit=i.handleSubmit.bind(_assertThisInitialized(i)),i.validateForm=i.validateForm.bind(_assertThisInitialized(i)),i}return _inherits(t,n),_createClass(t,[{key:"componentWillReceiveProps",value:function(n){this.setState({passwordErrorMessage:n.message})}},{key:"validateForm",value:function(){var t=this.state.form,n=!0,i=null,r=null;return this.emailRegex.test(t.emailAddress)||(i="Please enter a valid Email Address (i.e. name@domain.com).",n=!1),t.password||(r="Please enter a Password.",n=!1),this.setState({emailErrorMessage:i,passwordErrorMessage:r}),n}},{key:"handleFormChange",value:function(n){var i=n.target.type,r=n.target.name,u=i==="checkbox"?n.target.checked:n.target.value,t=this.state.form;t[r]=u;this.setState({form:t})}},{key:"handleSubmit",value:function(n){if(n.preventDefault(),this.validateForm())this.props.onSubmit(this.state.form)}},{key:"render",value:function(){return React.createElement("form",null,React.createElement("div",{className:"row login-registry"},React.createElement("div",{className:"col-xs-12"},React.createElement("h1",{className:"sign-in-header"},"Please Sign Into Your Account"),React.createElement("p",{className:"sign-in-msg"},"In order to add to a registry, you must be logged in.")),React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-12"},React.createElement("label",{htmlFor:"LoginPopupEmail"},"Email Address",React.createElement("span",{className:"required"}," Required")),React.createElement("input",{id:"LoginPopupEmail",name:"emailAddress",type:"email",maxLength:"66",onChange:this.handleFormChange,className:"input-xl","data-val-required":"Please enter a valid Email Address (i.e. name@domain.com).","data-val-email":"Please enter a valid Email Address (i.e. name@domain.com).","data-val-length":"'Email' must be between 0 and 66 characters.","data-val-length-max":"66","data-val":"true","aria-describedby":"PopupEmailError"}),React.createElement("span",{id:"PopupEmailError",className:"field-validation-valid","data-valmsg-htmlFor":"Email","data-valmsg-replace":"true",dangerouslySetInnerHTML:{__html:this.state.emailErrorMessage}})),React.createElement("div",{className:"col-xs-12"},React.createElement("label",{htmlFor:"LoginPopupPassword form-label",className:"password-label"},"Password",React.createElement("span",{className:"required"}," Required")),React.createElement("p",{className:"forgot-password"},React.createElement("a",{id:"forgot-password",className:"forgot-password-link",href:"javascript:;",onClick:this.props.onForgotPasswordClick},"Forgot your password?")),React.createElement("input",{id:"LoginPopupPassword",name:"password",type:"password",onChange:this.handleFormChange,maxLength:"18",autoComplete:"off",className:"input-xl","data-val-required":"Please choose a Password.","aria-describedby":"PopupPasswordError forgot-password"}),React.createElement("span",{id:"PopupPasswordError",className:"field-validation-valid","data-valmsg-htmlFor":"Password","data-valmsg-replace":"true",dangerouslySetInnerHTML:{__html:this.state.passwordErrorMessage}})),React.createElement("div",{className:"col-xs-12"},React.createElement("input",{id:"LoginPopupRememberMe",name:"rememberMe",type:"checkbox",className:"a11y-checkbox",defaultChecked:!0,onChange:this.handleFormChange}),React.createElement("label",{htmlFor:"LoginPopupRememberMe",className:"a11y-checkbox-label"},"Remember me")),React.createElement("div",{className:"col-xs-12 sign-in-agreement"},React.createElement("p",{id:"sign-in-agreement-msg"},"By signing in, you are agreeing to our ",React.createElement("a",{href:"/customer-service/terms-of-use"},"Terms of Use")," and ",React.createElement("a",{href:"/customer-service/privacy-policy"},"Privacy Policy"),"."),React.createElement("p",null,"Don't have an account? ",React.createElement("a",{href:"/account"},"Create an Account"))),React.createElement("div",{className:"col-xs-12"},React.createElement("button",{id:"popup-signin-button","aria-labelledby":"popup-signin-button sign-in-agreement-msg",className:"button button-primary button-xl",onClick:this.handleSubmit},"Sign In")))))}}]),t}(React.Component),LoginContainer=function(n){function t(n){var i;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n)),i.state={message:null,isForgotPasswordVisible:!1,isForgotPasswordConfirmationVisible:!1},i.handleLoginSubmit=i.handleLoginSubmit.bind(_assertThisInitialized(i)),i.handleLoginResult=i.handleLoginResult.bind(_assertThisInitialized(i)),i.handleForgotPasswordClick=i.handleForgotPasswordClick.bind(_assertThisInitialized(i)),i.handleForgotPasswordSubmit=i.handleForgotPasswordSubmit.bind(_assertThisInitialized(i)),i.handleForgotPasswordResult=i.handleForgotPasswordResult.bind(_assertThisInitialized(i)),i}return _inherits(t,n),_createClass(t,[{key:"close",value:function(){Crate.React.Actions.PopupActions.toggleOpen(!1)}},{key:"handleLoginResult",value:function(n){n.isSuccess?(this.props.onLoginSuccess(),this.close()):this.setState({message:n.message})}},{key:"handleForgotPasswordResult",value:function(n){this.setState({message:n.message,isForgotPasswordConfirmationVisible:n.isSuccess})}},{key:"handleLoginSubmit",value:function(n){Crate.Services.HttpService.post("/browse/ScbAccount/Login",n).then(this.handleLoginResult)}},{key:"handleForgotPasswordClick",value:function(){this.setState({isForgotPasswordVisible:!0})}},{key:"handleForgotPasswordSubmit",value:function(n){var t={EmailAddress:n};Crate.Services.HttpService.post("/browse/ScbAccount/ForgotPassword",t).then(this.handleForgotPasswordResult)}},{key:"render",value:function(){return this.state.isForgotPasswordConfirmationVisible?React.createElement(ForgotPasswordConfirmation,{message:this.state.message}):this.state.isForgotPasswordVisible?React.createElement(ForgotPassword,_extends({},this.state,{onSubmit:this.handleForgotPasswordSubmit})):React.createElement(Login,_extends({},this.props,this.state,{onSubmit:this.handleLoginSubmit,onForgotPasswordClick:this.handleForgotPasswordClick}))}}]),t}(React.Component)