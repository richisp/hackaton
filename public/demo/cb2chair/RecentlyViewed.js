"use strict";function _instanceof(n,t){return t!=null&&typeof Symbol!="undefined"&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](n):n instanceof t}function _typeof(n){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_typeof(n)}function _classCallCheck(n,t){if(!_instanceof(n,t))throw new TypeError("Cannot call a class as a function");}function _defineProperties(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function _createClass(n,t,i){return t&&_defineProperties(n.prototype,t),i&&_defineProperties(n,i),n}function _possibleConstructorReturn(n,t){return t&&(_typeof(t)==="object"||typeof t=="function")?t:_assertThisInitialized(n)}function _getPrototypeOf(n){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},_getPrototypeOf(n)}function _assertThisInitialized(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}});t&&_setPrototypeOf(n,t)}function _setPrototypeOf(n,t){return _setPrototypeOf=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},_setPrototypeOf(n,t)}var RecentlyViewed=function(n){var t=n.isMobile?{responsive:[{breakpoint:768,settings:n.recentlyViewedProducts.length<3?"unslick":{infinite:!1,speed:500,dots:!0,arrows:!1,slidesToShow:3,slidesToScroll:3,accessibility:!0}}]}:{responsive:[{breakpoint:1e5,dots:!1,settings:"unslick"}]},i=n.isCb2?"Take Another Look":"What caught your eye",r=n.recentlyViewedProducts.map(function(n,t){return React.createElement("div",{key:t,className:"recently-viewed-item"},React.createElement("a",{className:"recently-viewed-link",href:n.urlPath},React.createElement("img",{className:"recentlyViewedImg recently-viewed-img",src:n.imagePath,alt:n.name}),React.createElement("span",{className:"recently-viewed-description"},React.createElement("span",{className:"title"},n.name),React.createElement("span",{dangerouslySetInnerHTML:{__html:n.formatedPrice}}))))});return React.createElement("div",{className:"recently-viewed"},React.createElement("h2",{className:"section-header"},"Recently Viewed"),React.createElement("p",{className:"hidden-xs section-tagline"},i),React.createElement(Slider,t,r))},RecentlyViewedContainer=function(n){function t(n){var i;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,n)),i.state={sku:n.sku,familyId:n.familyId,optionChoices:null,recentlyViewedProducts:[],isCb2:n.isCb2=="True"?!0:!1,isMobile:n.isMobile=="True"?!0:!1},i.handleProductStoreUpdated=i.handleProductStoreUpdated.bind(_assertThisInitialized(i)),i.updateRecentlyViewedProducts=i.updateRecentlyViewedProducts.bind(_assertThisInitialized(i)),i.initFromSelectedProductStore=i.initFromSelectedProductStore.bind(_assertThisInitialized(i)),i}return _inherits(t,n),_createClass(t,[{key:"componentDidMount",value:function(){Crate.React.Stores.SelectedProductStore.listen(this.handleProductStoreUpdated);this.initFromSelectedProductStore()}},{key:"componentWillUnmount",value:function(){Crate.React.Stores.SelectedProductStore.unlisten(this.handleProductStoreUpdated)}},{key:"initFromSelectedProductStore",value:function(){var n=Crate.React.Stores.SelectedProductStore.getState();n&&Object.keys(n.selectedProduct).length!==0?this.handleProductStoreUpdated(n):this.updateRecentlyViewedProducts(!0)}},{key:"handleProductStoreUpdated",value:function(n){n.selectedProduct&&this.setState({sku:n.selectedProduct.sku,optionChoices:n.selectedProduct.optionChoices},this.updateRecentlyViewedProducts)}},{key:"updateRecentlyViewedProducts",value:function(n){var i=this,t;(n||this.state.sku>-1||this.state.familyId>-1)&&(t={sku:this.state.sku,familyId:this.state.familyId,optionChoices:this.state.optionChoices},Crate.Services.HttpService.post(this.props.updateUrl,t).then(function(n){i.setState({recentlyViewedProducts:n||[]})}))}},{key:"render",value:function(){return!this.state.recentlyViewedProducts||this.state.recentlyViewedProducts.length===0?null:React.createElement(RecentlyViewed,{recentlyViewedProducts:this.state.recentlyViewedProducts,isMobile:this.state.isMobile,isCb2:this.state.isCb2})}}]),t}(React.Component)